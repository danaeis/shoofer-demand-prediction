---
jupyter:
  jupytext:
    text_representation:
      extension: .Rmd
      format_name: rmarkdown
      format_version: '1.2'
      jupytext_version: 1.14.7
  kernelspec:
    display_name: Python 3 (ipykernel)
    language: python
    name: python3
---

```{python}
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sb
import re
from scipy.stats import norm
```

```{python}
INPUT_PATH = 'data/labels.parquet'
```

```{python}
def load_data(path):
    dataset = pd.read_parquet(path, engine = 'pyarrow')
    return dataset
```

```{python}
rides_df = load_data(INPUT_PATH)
rides_df.head()
```

```{python}
rides_df.columns=['Location','Data','Actual demand']
rides_df['Predict demand'] = rides_df['Actual demand'].shift(1)
rides_df.dropna(inplace = True)
rides_df.head()
```

```{python}
high_demand = pd.DataFrame(rides_df.groupby(rides_df['Location'])['Actual demand'].sum().sort_values(ascending=False)[:49])
ind_high_demand = high_demand.index
```

```{python}
plt.rcParams['figure.figsize'] = (50, 30)
bin = 50
for i,loc in enumerate(ind_high_demand):
    plt.subplot(10,5,i+1)
    error = rides_df[rides_df.Location==loc]['Actual demand'] - rides_df[rides_df.Location==loc]['Predict demand']
    sb.histplot(error, kde=True, bins=bin, label=f'Histogram and Estimated density o Location{i}')
plt.tight_layout()
plt.show()
```

```{python}

```
